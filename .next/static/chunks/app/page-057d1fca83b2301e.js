(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{305:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var s=r(7553),a=r(5525),n=r(5176),i=r(7140),o=r(7466);let l=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(n.b,{ref:t,className:(0,o.cn)(l(),r),...a})});d.displayName=n.b.displayName},1205:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>x});var s=r(7553),a=r(5525),n=r(8836),i=r(2319),o=r(3851),l=r(8445),d=r(6423),u=r(7131),c=r(1999),m=r(8793),f=r(3366);let h=f.Ik({email:f.Yj().email("Please enter a valid email address"),password:f.Yj().min(6,"Password must be at least 6 characters")});f.Ik({email:f.Yj().email("Please enter a valid email address"),password:f.Yj().min(6,"Password must be at least 6 characters"),confirmPassword:f.Yj()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});var p=r(9365),g=r(6393),v=r(3616);function x(){let[e,t]=(0,a.useState)(!1),r=(0,p.n)(e=>e.login),{toast:f}=(0,m.dj)(),x=(0,o.useRouter)(),y=(0,n.mN)({resolver:(0,i.u)(h),defaultValues:{email:"",password:""}}),b=async e=>{t(!0);try{var s;await r(e.email,e.password);let t=null==(s=p.n.getState().user)?void 0:s.role;"employee"==t?x.push("/dashboard/profile"):x.push("/dashboard")}catch(e){f({title:"فشل تسجيل الدخول",description:e.message,variant:"destructive"})}finally{t(!1)}};return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-card p-4",children:(0,s.jsxs)(d.Zp,{className:"w-full max-w-md",children:[(0,s.jsxs)(d.aR,{className:"space-y-1 text-center",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center mb-4",children:[(0,s.jsx)(g.A,{className:"h-8 w-8 text-primary mr-2"}),(0,s.jsx)("span",{className:"text-2xl font-bold",children:"نظام إدارة المعارض"})]}),(0,s.jsx)(d.ZB,{className:"text-2xl",children:"تسجيل الدخول"}),(0,s.jsx)(d.BT,{children:"أدخل بيانات الاعتماد الخاصة بك للوصول إلى حسابك"})]}),(0,s.jsx)(d.Wu,{children:(0,s.jsx)(c.lV,{...y,children:(0,s.jsxs)("form",{onSubmit:y.handleSubmit(b),className:"space-y-4",children:[(0,s.jsx)(c.zB,{control:y.control,name:"email",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"البريد الإلكتروني"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(u.p,{placeholder:"أدخل بريدك الإلكتروني",type:"email",...t})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsx)(c.zB,{control:y.control,name:"password",render:e=>{let{field:t}=e;return(0,s.jsxs)(c.eI,{children:[(0,s.jsx)(c.lR,{children:"كلمة المرور"}),(0,s.jsx)(c.MJ,{children:(0,s.jsx)(u.p,{placeholder:"أدخل كلمة المرور",type:"password",...t})}),(0,s.jsx)(c.C5,{})]})}}),(0,s.jsxs)(l.$,{type:"submit",className:"w-full",disabled:e,children:[e&&(0,s.jsx)(v.A,{className:"mr-2 h-4 w-4 animate-spin"}),"تسجيل الدخول"]})]})})})]})})}},1326:(e,t,r)=>{"use strict";r.d(t,{Zr:()=>a});let s=e=>t=>{try{let r=e(t);if(r instanceof Promise)return r;return{then:e=>s(e)(r),catch(e){return this}}}catch(e){return{then(e){return this},catch:t=>s(t)(e)}}},a=(e,t)=>(r,a,n)=>{let i,o={storage:function(e,t){let r;try{r=e()}catch(e){return}return{getItem:e=>{var t;let s=e=>null===e?null:JSON.parse(e,void 0),a=null!=(t=r.getItem(e))?t:null;return a instanceof Promise?a.then(s):s(a)},setItem:(e,t)=>r.setItem(e,JSON.stringify(t,void 0)),removeItem:e=>r.removeItem(e)}}(()=>localStorage),partialize:e=>e,version:0,merge:(e,t)=>({...t,...e}),...t},l=!1,d=new Set,u=new Set,c=o.storage;if(!c)return e((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${o.name}', the given storage is currently unavailable.`),r(...e)},a,n);let m=()=>{let e=o.partialize({...a()});return c.setItem(o.name,{state:e,version:o.version})},f=n.setState;n.setState=(e,t)=>{f(e,t),m()};let h=e((...e)=>{r(...e),m()},a,n);n.getInitialState=()=>h;let p=()=>{var e,t;if(!c)return;l=!1,d.forEach(e=>{var t;return e(null!=(t=a())?t:h)});let n=(null==(t=o.onRehydrateStorage)?void 0:t.call(o,null!=(e=a())?e:h))||void 0;return s(c.getItem.bind(c))(o.name).then(e=>{if(e)if("number"!=typeof e.version||e.version===o.version)return[!1,e.state];else{if(o.migrate){let t=o.migrate(e.state,e.version);return t instanceof Promise?t.then(e=>[!0,e]):[!0,t]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}return[!1,void 0]}).then(e=>{var t;let[s,n]=e;if(r(i=o.merge(n,null!=(t=a())?t:h),!0),s)return m()}).then(()=>{null==n||n(i,void 0),i=a(),l=!0,u.forEach(e=>e(i))}).catch(e=>{null==n||n(void 0,e)})};return n.persist={setOptions:e=>{o={...o,...e},e.storage&&(c=e.storage)},clearStorage:()=>{null==c||c.removeItem(o.name)},getOptions:()=>o,rehydrate:()=>p(),hasHydrated:()=>l,onHydrate:e=>(d.add(e),()=>{d.delete(e)}),onFinishHydration:e=>(u.add(e),()=>{u.delete(e)})},o.skipHydration||p(),i||h}},1999:(e,t,r)=>{"use strict";r.d(t,{C5:()=>v,MJ:()=>g,eI:()=>h,lR:()=>p,lV:()=>d,zB:()=>c});var s=r(7553),a=r(5525),n=r(7533),i=r(8836),o=r(7466),l=r(305);let d=i.Op,u=a.createContext({}),c=e=>{let{...t}=e;return(0,s.jsx)(u.Provider,{value:{name:t.name},children:(0,s.jsx)(i.xI,{...t})})},m=()=>{let e=a.useContext(u),t=a.useContext(f),{getFieldState:r,formState:s}=(0,i.xW)(),n=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:"".concat(o,"-form-item"),formDescriptionId:"".concat(o,"-form-item-description"),formMessageId:"".concat(o,"-form-item-message"),...n}},f=a.createContext({}),h=a.forwardRef((e,t)=>{let{className:r,...n}=e,i=a.useId();return(0,s.jsx)(f.Provider,{value:{id:i},children:(0,s.jsx)("div",{ref:t,className:(0,o.cn)("space-y-2",r),...n})})});h.displayName="FormItem";let p=a.forwardRef((e,t)=>{let{className:r,...a}=e,{error:n,formItemId:i}=m();return(0,s.jsx)(l.J,{ref:t,className:(0,o.cn)(n&&"text-destructive",r),htmlFor:i,...a})});p.displayName="FormLabel";let g=a.forwardRef((e,t)=>{let{...r}=e,{error:a,formItemId:i,formDescriptionId:o,formMessageId:l}=m();return(0,s.jsx)(n.DX,{ref:t,id:i,"aria-describedby":a?"".concat(o," ").concat(l):"".concat(o),"aria-invalid":!!a,...r})});g.displayName="FormControl",a.forwardRef((e,t)=>{let{className:r,...a}=e,{formDescriptionId:n}=m();return(0,s.jsx)("p",{ref:t,id:n,className:(0,o.cn)("text-sm text-muted-foreground",r),...a})}).displayName="FormDescription";let v=a.forwardRef((e,t)=>{let{className:r,children:a,...n}=e,{error:i,formMessageId:l}=m(),d=i?String(null==i?void 0:i.message):a;return d?(0,s.jsx)("p",{ref:t,id:l,className:(0,o.cn)("text-sm font-medium text-destructive",r),...n,children:d}):null});v.displayName="FormMessage"},3851:(e,t,r)=>{"use strict";var s=r(8739);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})},5274:(e,t,r)=>{Promise.resolve().then(r.bind(r,1205))},6393:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(2735).A)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]])},6423:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>u,ZB:()=>l,Zp:()=>i,aR:()=>o});var s=r(7553),a=r(5525),n=r(7466);let i=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});i.displayName="Card";let o=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",r),...a})});o.displayName="CardHeader";let l=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("h3",{ref:t,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});l.displayName="CardTitle";let d=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("p",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",r),...a})});d.displayName="CardDescription";let u=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",r),...a})});u.displayName="CardContent",a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",r),...a})}).displayName="CardFooter"},7131:(e,t,r)=>{"use strict";r.d(t,{p:()=>i});var s=r(7553),a=r(5525),n=r(7466);let i=a.forwardRef((e,t)=>{let{className:r,type:a,...i}=e;return(0,s.jsx)("input",{type:a,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...i})});i.displayName="Input"},7466:(e,t,r)=>{"use strict";r.d(t,{cn:()=>n});var s=r(2530),a=r(6747);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.QP)((0,s.$)(t))}},7966:(e,t,r)=>{"use strict";r.d(t,{v:()=>i});var s=r(5525);let a=e=>{let t,r=new Set,s=(e,s)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=s?s:"object"!=typeof a||null===a)?a:Object.assign({},t,a),r.forEach(r=>r(t,e))}},a=()=>t,n={setState:s,getState:a,getInitialState:()=>i,subscribe:e=>(r.add(e),()=>r.delete(e))},i=t=e(s,a,n);return n},n=e=>{let t=(e=>e?a(e):a)(e),r=e=>(function(e,t=e=>e){let r=s.useSyncExternalStore(e.subscribe,s.useCallback(()=>t(e.getState()),[e,t]),s.useCallback(()=>t(e.getInitialState()),[e,t]));return s.useDebugValue(r),r})(t,e);return Object.assign(r,t),r},i=e=>e?n(e):n},8445:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var s=r(7553),a=r(5525),n=r(7533),i=r(7140),o=r(7466);let l=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=a.forwardRef((e,t)=>{let{className:r,variant:a,size:i,asChild:d=!1,...u}=e,c=d?n.DX:"button";return(0,s.jsx)(c,{className:(0,o.cn)(l({variant:a,size:i,className:r})),ref:t,...u})});d.displayName="Button"},8793:(e,t,r)=>{"use strict";r.d(t,{dj:()=>c});var s=r(5525);let a=0,n=new Map,i=e=>{if(n.has(e))return;let t=setTimeout(()=>{n.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,t)},o=[],l={toasts:[]};function d(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?i(r):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),o.forEach(e=>{e(l)})}function u(e){let{...t}=e,r=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function c(){let[e,t]=s.useState(l);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},9365:(e,t,r)=>{"use strict";r.d(t,{n:()=>i});var s=r(7966),a=r(1326),n=r(261);let i=(0,s.v)()((0,a.Zr)(e=>{let t=(0,n.createClientComponentClient)();return{user:null,isAuthenticated:!1,isLoading:!1,login:async(r,s)=>{e({isLoading:!0});try{if("string"!=typeof r||"string"!=typeof s)throw Error("Email and password must be strings");let{data:a,error:n}=await t.auth.signInWithPassword({email:r.trim(),password:s.trim()});if(n)throw n;if(!a.user)throw Error("User not found after login");let{data:i,error:o}=await t.from("users").select("name, role").eq("auth_user_id",a.user.id).single();if(o)throw o;e({user:{id:a.user.id,email:a.user.email||r,name:(null==i?void 0:i.name)||"",role:(null==i?void 0:i.role)||"employee"},isAuthenticated:!0,isLoading:!1})}catch(t){throw e({isLoading:!1}),console.error("Login error:",t),t}},logout:async()=>{e({isLoading:!0});try{await t.auth.signOut()}finally{e({user:null,isAuthenticated:!1,isLoading:!1})}},checkAuth:async()=>{e({isLoading:!0});try{let{data:{session:n}}=await t.auth.getSession();if(null==n?void 0:n.user){var r,s,a;let{data:i,error:o}=await t.from("users").select("name, role").eq("auth_user_id",n.user.id).single();if(o||!i)throw o;e({user:{id:n.user.id,email:null!=(r=n.user.email)?r:"",name:null!=(s=i.name)?s:"",role:null!=(a=i.role)?a:"employee"},isAuthenticated:!0,isLoading:!1})}else e({user:null,isAuthenticated:!1,isLoading:!1})}catch(t){console.error("checkAuth error:",t),e({user:null,isAuthenticated:!1,isLoading:!1})}}}},{name:"auth-storage"}))}},e=>{e.O(0,[120,261,83,552,772,358],()=>e(e.s=5274)),_N_E=e.O()}]);